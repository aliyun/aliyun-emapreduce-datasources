This implementation is partially borrowed from https://github.com/LioRoger/subscribe_example/tree/master/javaimpl